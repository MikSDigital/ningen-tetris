(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{183:function(e,t,r){var n=r(251);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(10).default)("4810089a",n,!0,{sourceMap:!1})},199:function(e,t,r){var n=r(343);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(10).default)("798c3abc",n,!0,{sourceMap:!1})},201:function(e,t,r){e.exports=r.p+"img/b6ab656.png"},202:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(203),o=r.n(n),i=r(204),a=r.n(i),c=(r(205),r(246),function(){function e(t,r,n,i,a){o()(this,e),this.blockType=n,this.x=this.sx=t,this.y=this.sy=r,this.oBlock=i,this.blockSize=a}return a()(e,[{key:"refreshMino",value:function(e,t,r,n,o){this.blockType=r,this.x=this.sx=e,this.y=this.sy=t;for(var i=Math.floor(4*Math.random())+1,a=0;a<4;a++)for(var c=0;c<4;c++)this.oBlock[a][c].blockType=n[a][c],this.oBlock[a][c].pattern=i;this.blockSize=o}},{key:"drop",value:function(e,t){this.y++,this.hitCheck(e)&&(this.y=this.sy,t())}},{key:"replaceBlock",value:function(e){for(var t=0;t<4;t++)for(var r=0;r<4;r++)this.oBlock[t][r].blockType=e[t][r].blockType,this.oBlock[t][r].pattern=e[t][r].pattern}},{key:"rotate",value:function(e){for(var t=JSON.parse(JSON.stringify(this.oBlock)),r=0;r<4;r++)for(var n=0;n<4;n++)this.oBlock[r][n].blockType=t[3-n][r].blockType,this.oBlock[r][n].pattern=t[3-n][r].pattern;this.hitCheck(e)&&this.replaceBlock(t)}},{key:"setBlockInField",value:function(e){for(var t=0;t<4;t++)for(var r=0;r<4;r++)this.oBlock[t][r].blockType&&(e[t+this.y][r+this.x].blockType=this.oBlock[t][r].blockType,e[t+this.y][r+this.x].pattern=this.oBlock[t][r].pattern)}},{key:"hitCheck",value:function(e){for(var t=0;t<4;t++)for(var r=0;r<4;r++)if(void 0!==e[t+this.y][r+this.x]&&e[t+this.y][r+this.x].blockType&&1==this.oBlock[t][r].blockType)return!0;return!1}},{key:"gameOverCheck",value:function(e){if(this.x<0||this.x>e[0].length-2-2)return!0;for(var t=0;t<4;t++)for(var r=0;r<4;r++)if(0==this.y&&1==this.oBlock[t][r].blockType&&2==e[t+this.y][r+this.x].blockType)return!0;return!1}},{key:"setBlockType",value:function(e,t){for(var r=0;r<4;r++)for(var n=0;n<4;n++)this.oBlock[r][n].blockType&&(e[r+this.y][n+this.x].blockType=t,e[r+this.y][n+this.x].pattern=this.oBlock[r][n].pattern)}},{key:"returnPosition",value:function(){this.x=this.sx,this.y=this.sy}},{key:"keepInterimPosition",value:function(){this.sx=this.x,this.sy=this.y}},{key:"drawMinoBlock",value:function(e){e.push();for(var t=this.blockSize,r=0;r<4;r++)for(var n=0;n<4;n++)if(this.oBlock[r][n].blockType){var o=t-1,i={p5:e,x:(this.x+n)*t,y:(this.y+r)*t,w:o,h:o};this.oBlock[r][n].registerFunction(i)}e.pop()}}]),e}())},205:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Block});var core_js_modules_es6_array_fill__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(177),core_js_modules_es6_array_fill__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_array_fill__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(203),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(204),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__),Block=function(){function Block(e){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,Block),this.blockType=e,this.pattern=1,this.patternNum=10}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(Block,[{key:"registerFunction",value:function registerFunction(response){for(var functions={},i=1;i<=this.patternNum;i++){var key="pattern"+i;functions[key]=eval("this.drawPattern"+i)}var name="pattern"+this.pattern;void 0!==functions[name]?functions[name](response):console.log("This function is not regsted : "+name)}},{key:"drawPattern1",value:function(e){var t=e.p5,r=e.x,n=e.y,o=e.w,i=e.h,a=o;t.push(),t.translate(r,n),t.fill(255),t.rect(0,0,o,i),t.noStroke(),t.fill(131,18,28),t.beginShape(),t.vertex(a/3,0),t.vertex(a/3+a/3,0),t.vertex(a,a/3),t.vertex(a,a/3+a/3),t.vertex(a/3+a/3,a),t.vertex(a/3,a),t.vertex(0,a/3+a/3),t.vertex(0,a/3),t.endShape(t.CLOSE),t.noStroke(),t.fill(142,75,28),t.ellipse(a/2,a/2,10,10),t.pop()}},{key:"drawPattern2",value:function(e){var t=e.p5,r=e.x,n=e.y,o=e.w,i=e.h;t.push(),t.noFill(),t.strokeWeight(4),t.translate(r,n),t.fill(255),t.rect(0,0,o,i);for(var a=o/4,c=0,s=o;s>0;s-=a){c%2==0?t.stroke(131,18,28):t.stroke(142,75,28);var l=s;t.arc(o/2,i,l,l,t.PI,0),c++}t.pop()}},{key:"drawLineWithVector",value:function(e,t,r){e.line(t.x,t.y,r.x,r.y)}},{key:"drawPattern3",value:function(e){var t=e.p5,r=e.x,n=e.y,o=e.w,i=e.h;t.push(),t.translate(r,n),t.fill(255),t.rect(0,0,o,i);var a=o/4,c=i/4,s=t.createVector(0,0),l=t.createVector(0+a,0),u=t.createVector(0+2*a,0),f=t.createVector(0+3*a,0),p=(t.createVector(0+o,0),t.createVector(0+o,0+c)),h=t.createVector(0+o,0+2*c),_=t.createVector(0+o,0+3*c),y=t.createVector(0+o,0+i),v=t.createVector(0+3*a,0+i),d=t.createVector(0+2*a,0+i),k=t.createVector(0+a,0+i),x=(t.createVector(0,0+i),t.createVector(0,0+3*c)),b=t.createVector(0,0+2*c),m=t.createVector(0,0+c);t.strokeWeight(3),t.stroke(131,18,28),t.line(s.x,s.y,y.x,y.y),t.line(l.x,l.y,_.x,_.y),t.line(u.x,u.y,h.x,h.y),t.line(f.x,f.y,p.x,p.y),t.line(m.x,m.y,v.x,v.y),t.line(b.x,b.y,d.x,d.y),t.line(x.x,x.y,k.x,k.y),t.pop()}},{key:"drawPattern4",value:function(e){var t=e.p5,r=e.x,n=e.y,o=e.w,i=e.h;t.push(),t.translate(r,n),t.fill(255),t.rect(0,0,o,i);var a=o/4,c=i/4,s=t.createVector(0,0),l=t.createVector(0+a,0),u=t.createVector(0+2*a,0),f=t.createVector(0+3*a,0),p=t.createVector(0+o,0),h=t.createVector(0+o,0+c),_=t.createVector(0+o,0+2*c),y=t.createVector(0+o,0+3*c),v=t.createVector(0+o,0+i),d=t.createVector(0+3*a,0+i),k=t.createVector(0+2*a,0+i),x=t.createVector(0+a,0+i),b=t.createVector(0,0+i),m=t.createVector(0,0+3*c),g=t.createVector(0,0+2*c),w=t.createVector(0,0+c);t.strokeWeight(2),t.stroke(131,18,28),t.line(s.x,s.y,v.x,v.y),t.line(l.x,l.y,y.x,y.y),t.line(u.x,u.y,_.x,_.y),t.line(f.x,f.y,h.x,h.y),t.line(w.x,w.y,d.x,d.y),t.line(g.x,g.y,k.x,k.y),t.line(m.x,m.y,x.x,x.y),t.stroke(142,75,28),t.line(p.x,p.y,b.x,b.y),t.line(f.x,f.y,m.x,m.y),t.line(u.x,u.y,g.x,g.y),t.line(l.x,l.y,w.x,w.y),t.line(h.x,h.y,x.x,x.y),t.line(_.x,_.y,k.x,k.y),t.line(y.x,y.y,d.x,d.y),t.pop()}}]),Block}()},243:function(e,t,r){e.exports=r.p+"img/d105c44.png"},244:function(e,t,r){e.exports=r.p+"img/2ee1748.png"},248:function(e,t,r){"use strict";r.r(t),r.d(t,"mino",function(){return n}),r.d(t,"setDelegate",function(){return S}),r.d(t,"mainGame",function(){return U}),r.d(t,"updateLayout",function(){return A});r(177);var n,o,i,a,c,s,l,u,f,p,h=r(202),_=r(205),y=(r(92),550),v=750,d=34,k=d*i,x=d*o,b=1,m=0,g=2,w=-1,C=0,T=1,M=2,B=3,P=9,E=10,O=new Array(i),V=new Array(i),D=new Array,I=new Array,R=0;function S(e){p=e}function U(e){(f=e).preload=function(e){f.loadImage("img/download.png")},f.keyPressed=function(e){},f.setup=function(e){o=Math.floor(v/d),i=Math.floor(y/d),f.createCanvas(y,v).parent("p5Canvas"),f.background(60,46,64),u=0,a=d,D=[[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[0,1,0,0],[0,1,0,0]],[[0,0,0,0],[0,1,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,1,0,0],[1,1,1,0],[0,0,0,0]]],window.onkeydown=t,L()},f.draw=function(e){f.background(60,46,64),K(),f.text(Math.floor(f.frameRate()),550,50)};var t=function(e){l!=g&&(l==b?(n.setBlockType(V,C),n.keepInterimPosition(),32==e.keyCode?q():37==e.keyCode?n.x--:39==e.keyCode?n.x++:40==e.keyCode&&n.y++,n.hitCheck(V)&&n.returnPosition(),F()):l==m&&13==e.keyCode&&L())}}function A(e){!function(e){if(l==b){n.setBlockType(V,C),n.keepInterimPosition();var t=e[0].position.x,r=Math.floor(f.map(t,0,y,1,i-1));n.x=r;var o=e[1].position,a=e[2].position,c=(o.y-a.y)/(o.x-a.x);c>1&&q(),n.hitCheck(V)&&n.returnPosition(),F()}}(e)}function L(){!function(){I.fill(0),O=JSON.parse(JSON.stringify(new Array(o).fill(new Array(i).fill(0))));for(var e=0;e<O.length;e++)for(var t=0;t<O[e].length;t++)0===e||e===O.length-1?O[e][t]=new _.a(w):0===t||t===O[e].length-1||e===O.length-2?O[e][t]=new _.a(P):O[e][t]=new _.a(C);V=O}(),l=b,s=1,c=5,R=0,j(),K(),W()}function W(){p({gameMode:l,score:R})}function j(){if(l!=g){var e=Math.floor(i/3),t=Math.floor(Math.random()*D.length),r=JSON.parse(JSON.stringify(new Array(4).fill(new Array(4).fill(0)))),o=D[t];if(void 0===n){for(var c=Math.floor(4*Math.random())+1,s=0;s<4;s++)for(var u=0;u<4;u++){var f=void 0;1==o[s][u]?(f=new _.a(T)).pattern=c:f=new _.a(C),r[s][u]=f}n=new h.a(e,0,t,r,a)}else n.refreshMino(e,0,t,o,a);n.gameOverCheck(V)&&(l=m),F()}}function K(){l==b?(n.keepInterimPosition(),s%c==0&&(n.setBlockType(V,C),n.drop(V,function(){n.setBlockType(V,M);var e=function(){if(l==g)return;for(var e,t=0,r=1;r<o-2;r++){e=0;for(var n=0;n<i&&V[r][n].blockType;n++)e++;if(e>=i){t++,u++;for(var a=1;a<i-1;a++)V[r][a].blockType=B}}return t}();if(e>0){l=b,function(){if(l==g)return;for(var e=o-1;e>=1;e--)for(var t=1;t<i-1;t++)if(V[e][t].blockType==B){V[e][t].blockType=V[e-1][t].blockType;for(var r=e-1;r>=1;r--)V[r][t].blockType=V[r-1][t].blockType;e++}}(),console.log(e);for(var t=1;t<e+1;t++)for(var r=0;r<i;r++)V[t][r].blockType!==P&&(V[t][r].blockType=C);R+=10*e,W()}j()}),F()),f.push(),f.fill(221,221,221),f.rect(0,0,k,x),f.pop(),function(){for(var e=0;e<o;e++)for(var t=0;t<i;t++){switch(f.push(),0!==e&&e!==V.length-1||(V[e][t].blockType=w),V[e][t].blockType){case w:f.noFill(),f.noStroke(),f.rect(t*a,e*a,a-1,a-1);break;case C:f.stroke(204),f.fill(247,241,213),f.rect(t*a,e*a,a-1,a-1);break;case M:var r=a-1,n={p5:f,x:t*a,y:e*a,w:r,h:r};V[e][t].registerFunction(n);break;case B:f.fill(0),f.rect(t*a,e*a,a-1,a-1);break;case P:f.fill(204),f.rect(t*a,e*a,a-1,a-1)}f.pop()}}(),n.drawMinoBlock(f)):l==m&&function(){f.push();for(var e=0;e<o;e++)for(var t=0;t<i;t++)V[e][t].blockType&&V[e][t].blockType!=P&&(f.fill(255),f.rect(t*a,e*a,a-1,a-1));f.pop()}(),s++,u>=E&&(u=0,c--,console.log("speedUP! : "+c)),c<1&&(c=1)}function q(){l!=g&&(n.setBlockType(V,C),n.rotate(V))}function F(){l!=g&&n.setBlockInField(V)}},250:function(e,t,r){"use strict";var n=r(183);r.n(n).a},251:function(e,t,r){(e.exports=r(9)(!1)).push([e.i,"",""])},254:function(e,t){},256:function(e,t){},289:function(e,t){},290:function(e,t){},342:function(e,t,r){"use strict";var n=r(199);r.n(n).a},343:function(e,t,r){(e.exports=r(9)(!1)).push([e.i,"\nbody{background:#3c2e40\n}\n.header{color:#87c166\n}\n.human-container video{display:none\n}\n.human-container canvas,.human-container video{opacity:.65;top:0;left:0;right:0;bottom:0;margin:auto\n}\n.score{top:50px;left:32px;font-size:30px;letter-spacing:25px;color:#f597ab\n}\n.howto-container{margin-top:50px\n}\ntable td{width:50px;height:50px;border:1px solid #000\n}",""])},344:function(e,t,r){"use strict";r.r(t);r(177),r(27),r(47);var n=r(4),o=r.n(n),i=r(206),a=r(337),c=r.n(a),s=(r(200),"aqua"),l=2;function u(e){return[e.y,e.x]}function f(e,t,r,n,o){e.beginPath(),e.arc(r,t,n,0,2*Math.PI),e.fillStyle=o,e.fill()}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;i.a(e,t).forEach(function(e){!function(e,t,r,n,o){var i=c()(e,2),a=i[0],s=i[1],u=c()(t,2),f=u[0],p=u[1];o.beginPath(),o.moveTo(s*n,a*n),o.lineTo(p*n,f*n),o.lineWidth=l,o.strokeStyle=r,o.stroke()}(u(e[0].position),u(e[1].position),s,n,r)})}function h(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=0;o<e.length;o++){var i=e[o];if(!(i.score<t)){var a=i.position;f(r,a.y*n,a.x*n,3,s)}}}var _=r(341),y=r.n(_);r.d(t,"sqrt",function(){return M}),r.d(t,"startPosenet",function(){return B}),r.d(t,"setDelegate",function(){return P});var v,d=.5,k=16,x=new y.a,b=640,m=480,g=.1,w=.1,C=1,T=30,M=Math.sqrt;function B(){!function(){E.apply(this,arguments)}()}function P(e){v=e}function E(){return(E=o()(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.c();case 2:return t=e.sent,e.prev=3,e.next=6,O();case 6:r=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),console.error(e.t0),e.abrupt("return");case 13:R(r,t);case 14:case"end":return e.stop()}},e,this,[[3,9]])}))).apply(this,arguments)}function O(){return V.apply(this,arguments)}function V(){return(V=o()(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return(t=e.sent).play(),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function D(){return I.apply(this,arguments)}function I(){return(I=o()(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("video"),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){e.next=9;break}return e.next=4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 4:return r=e.sent,t.srcObject=r,e.abrupt("return",new Promise(function(e){t.onloadedmetadata=function(){e(t)}}));case 9:return n="This browser does not support video capture, or this device does not have a camera",alert(n),e.abrupt("return",Promise.reject(n));case 12:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function R(e,t){var r=document.getElementById("canvas").getContext("2d"),n=!0;function i(){return a.apply(this,arguments)}function a(){return(a=o()(regeneratorRuntime.mark(function o(){var a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return x.begin(),o.next=3,t.estimateMultiplePoses(e,d,n,k,C,g,T);case 3:a=o.sent,r.clearRect(0,0,b,m),r.save(),r.scale(-1,1),r.translate(-b,0),r.drawImage(e,0,0,b,m),r.restore(),a.forEach(function(e){var t=e.score,n=e.keypoints;t>=w&&(h(n,g,r),p(n,g,r),v(n,t))}),x.end(),requestAnimationFrame(i);case 13:case"end":return o.stop()}},o,this)}))).apply(this,arguments)}i()}},345:function(e,t,r){"use strict";r.r(t);var n=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header col-md-6 d-flex justify-content-center py-3"},[t("h1",[this._v("NINGEN TETRIS")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"human-container",staticStyle:{}},[t("video",{staticStyle:{position:"absolute"},attrs:{id:"video",width:"640px",height:"480px"}}),this._v(" "),t("canvas",{staticStyle:{position:"absolute"},attrs:{id:"canvas",width:"640px",height:"480px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"howto-container row"},[t("div",{staticClass:"move-box col-md-6"},[t("img",{staticClass:"img-fluid",attrs:{src:r(243),alt:""}})]),this._v(" "),t("div",{staticClass:"rotate-box col-md-6"},[t("img",{staticClass:"img-fluid",attrs:{src:r(244),alt:""}})])])}],o=r(25),i=r.n(o),a=(r(202),r(248)),c={data:function(){return{keypoints:[],mino:{},p5js:{}}},methods:{setKeyPoints:function(e){a.updateLayout(e)},callbackOnTetris:function(e){console.log("callback: "+e),1==e.gameMode&&this.$store.dispatch("setScore",e.score)}},mounted:function(){a.setDelegate(this.callbackOnTetris);var e=r(249);this.p5js=new e(a.mainGame)}},s=(r(250),r(24)),l=Object(s.a)(c,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container border "},[t("div",{ref:"canvas",staticClass:"d-flex justify-content-center",attrs:{id:"p5Canvas"}})])},[],!1,null,null,null);l.options.__file="TetrisFrame.vue";var u=l.exports,f=r(33),p=r(344),h={components:{TetrisFrame:u},data:function(){return{posenet:{},keypoints:[],pStyle:{"background-image":"url("+r(201)+")"}}},mounted:function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({video:!0,audio:!0},function(e){document.getElementById("video").src=URL.createObjectURL(e)},function(e){console.log(e)}),p.setDelegate(this.callbackDelegate),p.startPosenet()},methods:i()({callbackDelegate:function(e,t){this.$refs.tetris.setKeyPoints(e)}},Object(f.b)({getList:"index/getScore"}))},_=(r(342),Object(s.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container-fluid border"},[e._m(0),e._v(" "),n("div",{staticClass:"row border"},[n("div",{staticClass:"tetris-container col-md-6 border"},[e._m(1),e._v(" "),n("tetris-frame",{ref:"tetris"})],1),e._v(" "),n("div",{staticClass:"info-container col-md-6 mb-3 border"},[n("div",{staticClass:"score-container row"},[n("div",{staticClass:"position-relative score-box col-md-6"},[n("img",{staticClass:"img-fluid",attrs:{src:r(201),alt:""}}),e._v(" "),n("span",{staticClass:"score position-absolute"},[e._v("\n            "+e._s(e.$store.state.score)+"\n          ")])])]),e._v(" "),e._m(2),e._v(" "),n("div",{staticClass:"mino-info-container row"})])])])},n,!1,null,null,null));_.options.__file="index.vue";t.default=_.exports}}]);